<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Event Registration</title>
<link rel="stylesheet" href="style.css">
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>

<form id="registrationForm">
    <div class="row">
        <div>
            <label>First Name *</label>
            <input type="text" name="FirstName" required>
        </div>
        <div>
            <label>Last Name *</label>
            <input type="text" name="LastName" required>
        </div>
    </div>

    <div class="row">
        <div>
            <label>Job Title *</label>
            <input type="text" name="JobTitle" required>
        </div>
        <div>
            <label>Company Name *</label>
            <input type="text" name="CompanyName" required>
        </div>
    </div>

    <div class="row">
        <div>
            <label>Email *</label>
            <input type="email" name="Email" required>
        </div>
        <div>
            <label>Phone Number *</label>
            <select name="CountryCode" style="width:40%;">
                <option value="+966">Saudi (+966)</option>
                <option value="+971">UAE (+971)</option>
                <option value="+91">India (+91)</option>
            </select>
            <input type="tel" name="Phone" required style="width:58%; display:inline-block;">
        </div>
    </div>

    <label>Which one of our upcoming events would you like to enquire for? *</label>
    <input type="checkbox" name="Event" value="DATE MENA"> DATE MENA: 26 - 27 November 2025 | Dubai <br>
    <input type="checkbox" name="Event" value="DATE KSA"> DATE KSA: 8 - 9 December 2025 | Riyadh <br>
    <input type="checkbox" name="Event" value="Both"> Both/Any

    <label>
        <input type="checkbox" name="Consent" value="Yes" required> I agree to receive communications from Trescon. *
    </label>
    <small>You can unsubscribe at any time. See our Privacy Policy for details.</small>

    <div style="margin: 15px 0;">
        <div class="g-recaptcha" data-sitekey="YOUR_SITE_KEY"></div>
    </div>

    <button type="submit">Submit</button>
</form>

<script src="script.js"></script>

</body>
</html>

Instructions to Deploy the Registration Form

1. Google Sheets Setup:
   - Create a Google Sheet with columns:
     First Name | Last Name | Job Title | Company Name | Email | Country Code | Phone | Event | Consent | Timestamp

2. Google Apps Script Setup:
   - In Google Sheets, go to Extensions > Apps Script.
   - Paste the provided Google Apps Script code and replace YOUR_RECAPTCHA_SECRET_KEY with your secret key from Google reCAPTCHA.
   - Deploy as Web App: Execute as 'Me', Who has access: 'Anyone'.
   - Copy the Web App URL and replace in script.js (already set in this package).

3. Google reCAPTCHA Setup:
   - Go to https://www.google.com/recaptcha/admin/create
   - Register your domain (github.io domain if hosting on GitHub Pages).
   - Get the SITE KEY and SECRET KEY.
   - Replace YOUR_SITE_KEY in index.html.
   - Replace YOUR_RECAPTCHA_SECRET_KEY in Apps Script.

4. Deploy on GitHub Pages:
   - Create a new repository.
   - Upload all files from this ZIP.
   - Commit changes.
   - Go to Settings > Pages, choose 'main' branch, and root folder.
   - Your form will be live at https://your-username.github.io/repo-name/

5. Test the Form:
   - Open your GitHub Pages link.
   - Fill out the form, complete the reCAPTCHA, and submit.
   - Check your Google Sheet for new entries.

const scriptURL = 'https://script.google.com/macros/s/AKfycbyqtX75MYitTWN0dqUmuUXGS7DKtgjfiUdTN-FBVrHcmptZ6WyZAC-4r0W9SalRRs-bJQ/exec';
const form = document.getElementById('registrationForm');

form.addEventListener('submit', e => {
    e.preventDefault();

    // Check reCAPTCHA
    if (grecaptcha.getResponse() === '') {
        alert('Please complete the reCAPTCHA');
        return;
    }

    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                alert('Form submitted successfully!');
                form.reset();
                grecaptcha.reset();
            } else {
                alert('Submission failed: ' + data.message);
            }
        })
        .catch(error => alert('Error: ' + error.message));
});
body {
    font-family: Arial, sans-serif;
    background: #f9f9f9;
    padding: 20px;
}
form {
    max-width: 700px;
    margin: auto;
    background: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
label {
    display: block;
    font-weight: bold;
    margin-top: 10px;
}
input, select, button {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    border: 1px solid #ccc;
    border-radius: 5px;
}
.row {
    display: flex;
    gap: 10px;
}
.row > div {
    flex: 1;
}
button {
    background: #0056b3;
    color: white;
    border: none;
    margin-top: 15px;
    cursor: pointer;
}
button:hover {
    background: #004494;
}
small {
    font-size: 12px;
    color: #666;
}
