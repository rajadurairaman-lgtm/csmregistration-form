document.getElementById('registrationForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const formData = {
        FirstName: this.FirstName.value,
        LastName: this.LastName.value,
        JobTitle: this.JobTitle.value,
        CompanyName: this.CompanyName.value,
        Email: this.Email.value,
        CountryCode: this.CountryCode.value,
        Phone: this.Phone.value,
        Event: Array.from(document.querySelectorAll('input[name="Event"]:checked'))
                    .map(e => e.value).join(', '),
        Consent: this.Consent.checked ? 'Yes' : 'No'
    };

    fetch("https://script.google.com/macros/s/AKfycbyqtX75MYitTWN0dqUmuUXGS7DKtgjfiUdTN-FBVrHcmptZ6WyZAC-4r0W9SalRRs-bJQ/exec", {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(formData)
    }).then(() => {
        alert("Form submitted successfully!");
        this.reset();
    }).catch(err => {
        console.error(err);
        alert("Error submitting the form.");
    });
});
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Event Registration</title>
<link rel="stylesheet" href="style.css">
<script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>
<body>

<form id="registrationForm">
    <div class="row">
        <div>
            <label>First Name *</label>
            <input type="text" name="FirstName" required>
        </div>
        <div>
            <label>Last Name *</label>
            <input type="text" name="LastName" required>
        </div>
    </div>

    <div class="row">
        <div>
            <label>Job Title *</label>
            <input type="text" name="JobTitle" required>
        </div>
        <div>
            <label>Company Name *</label>
            <input type="text" name="CompanyName" required>
        </div>
    </div>

    <div class="row">
        <div>
            <label>Email *</label>
            <input type="email" name="Email" required>
        </div>
        <div>
            <label>Phone Number *</label>
            <select name="CountryCode" style="width:40%;">
                <option value="+966">Saudi (+966)</option>
                <option value="+971">UAE (+971)</option>
                <option value="+91">India (+91)</option>
            </select>
            <input type="tel" name="Phone" required style="width:58%; display:inline-block;">
        </div>
    </div>

    <label>Which one of our upcoming events would you like to enquire for? *</label>
    <input type="checkbox" name="Event" value="DATE MENA"> DATE MENA: 26 - 27 November 2025 | Dubai <br>
    <input type="checkbox" name="Event" value="DATE KSA"> DATE KSA: 8 - 9 December 2025 | Riyadh <br>
    <input type="checkbox" name="Event" value="Both"> Both/Any

    <label>
        <input type="checkbox" name="Consent" value="Yes" required> I agree to receive communications from Trescon. *
    </label>
    <small>You can unsubscribe at any time. See our Privacy Policy for details.</small>

    <div style="margin: 15px 0;">
        <div class="g-recaptcha" data-sitekey="YOUR_SITE_KEY"></div>
    </div>

    <button type="submit">Submit</button>
</form>

<script src="script.js"></script>

</body>
</html>
body {
    font-family: Arial, sans-serif;
    background: #f9f9f9;
    padding: 20px;
}

form {
    background: #fff;
    padding: 20px;
    max-width: 600px;
    margin: auto;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

.row {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

label {
    display: block;
    font-weight: bold;
    margin-bottom: 5px;
}

input, select, button {
    width: 100%;
    padding: 8px;
    box-sizing: border-box;
}

button {
    background-color: #007BFF;
    color: white;
    border: none;
    cursor: pointer;
}

button:hover {
    background-color: #0056b3;
}
